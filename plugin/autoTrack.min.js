let autoTrack={_sa:null};const forEach=Array.prototype.forEach,slice=Array.prototype.slice,_hasOwnProperty=Object.prototype.hasOwnProperty,_toString=Object.prototype.toString;function extend(a){return each(slice.call(arguments,1),function(t){for(var e in t)void 0!==t[e]&&(a[e]=t[e])}),a}function isObject(a){return null!==a&&'object'==typeof a}function isFunction(a){if(!a)return!1;var t=Object.prototype.toString.call(a);return'[object Function]'==t||'[object AsyncFunction]'==t||'[object GeneratorFunction]'==t}function isString(a){return'[object String]'==_toString.call(a)}function each(a,t,e){if(null==a)return!1;if(forEach&&a.forEach===forEach)a.forEach(t,e);else if(a.length===+a.length){for(var r=0,n=a.length;r<n;r++)if(r in a&&t.call(e,a[r],r,a)==={})return!1}else for(var o in a)if(_hasOwnProperty.call(a,o)&&t.call(e,a[o],o,a)==={})return!1}function getPath(a){return a='string'==typeof a?a.replace(/^\//,''):'\u53d6\u503c\u5f02\u5e38'}function getCurrentPath(){var a='\u672a\u53d6\u5230',t=getCurrentPage();return t&&t.route&&(a=t.route),a}function getCurrentPage(){var a,t={};try{t=(a='sensorsdata2015_binance'===autoTrack._sa.storageName?autoTrack._sa.platform_obj.getCurrentPages():getCurrentPages())[a.length-1]}catch(a){autoTrack._sa.log(a)}return t}function getScene(a){return!(!autoTrack._sa.scene_prefix||!isString(autoTrack._sa.scene_prefix))&&('number'==typeof a||'string'==typeof a&&''!==a?a=autoTrack._sa.scene_prefix+String(a):'\u672a\u53d6\u5230\u503c')}function appLaunch(a,t){var e={};if(a&&a.path&&(e.$url_path=getPath(a.path)),a&&a.scene){var r=getScene(a.scene);r&&(e.$scene=r,autoTrack._sa.registerApp({$latest_scene:r}))}autoTrack._sa.is_first_launch?e.$is_first_time=!0:e.$is_first_time=!1,isObject(t)&&(e=extend(e,t)),autoTrack._sa.para.autoTrack.appLaunch&&autoTrack._sa.track('$MPLaunch',e)}function appShow(a,t){var e={};if(isObject(t)&&(e=extend(e,t)),autoTrack._sa.mpshow_time=(new Date).getTime(),a&&a.path&&(e.$url_path=getPath(a.path)),a&&a.scene){var r=getScene(a.scene);r&&(e.$scene=r,autoTrack._sa.registerApp({$latest_scene:r}))}autoTrack._sa.para.autoTrack.appShow&&autoTrack._sa.track('$MPShow',e)}function appHide(a){var t=(new Date).getTime(),e={};isObject(a)&&(e=extend(e,a)),e.$url_path=getCurrentPath(),autoTrack._sa.mpshow_time&&t-autoTrack._sa.mpshow_time>0&&(t-autoTrack._sa.mpshow_time)/36e5<24&&(e.event_duration=(t-autoTrack._sa.mpshow_time)/1e3),autoTrack._sa.para.autoTrack.appHide&&autoTrack._sa.track('$MPHide',e)}function pageShow(a){var t={},e=getCurrentPath();isObject(a)&&(t=extend(t,a)),t.$url_path=e,t.$referrer=autoTrack._sa.sa_referrer,autoTrack._sa.para.autoTrack.pageShow&&autoTrack._sa.track('$MPViewScreen',t),autoTrack._sa.sa_referrer=e}function pageLoad(a){}const MP_HOOKS={data:1,onLoad:1,onShow:1,onReady:1,onPullDownRefresh:1,onReachBottom:1,onShareAppMessage:1,onPageScroll:1,onResize:1,onTabItemTap:1,onHide:1,onUnload:1};function isClick(a){return!!{tap:1,longtap:1,longpress:1}[a]}function getMethods(a){var t=[];for(var e in a)'function'!=typeof a[e]||MP_HOOKS[e]||t.push(e);return t}function clickTrack(a){var t,e={},r={},n=a.currentTarget||{},o=a.target||{};if(isObject(autoTrack._sa.para.framework)&&isObject(autoTrack._sa.para.framework.taro)&&!autoTrack._sa.para.framework.taro.createApp&&o.id&&n.id&&o.id!==n.id)return!1;var c=n.dataset||{};if(t=a.type,e.$element_id=n.id,e.$element_type=c.type,e.$element_content=c.content,e.$element_name=c.name,isObject(a.event_prop)&&(r=a.event_prop),t&&isClick(t)){if(autoTrack._sa.para.preset_events&&autoTrack._sa.para.preset_events.collect_element&&!1===autoTrack._sa.para.preset_events.collect_element(arguments[0]))return!1;if(e.$url_path=getCurrentPath(),binanceClickFilter(e))return!1;e=extend(e,r),autoTrack._sa.track('$MPClick',e)}}function binanceClickFilter(a){var t=!1;return a.$element_id.indexOf(a.$url_path)>=0&&(t=!0),t}function clickProxy(a,t){var e=a[t];a[t]=function(){var a=e.apply(this,arguments),t=arguments[0];return isObject(t)&&clickTrack(t),a}}var preset_events={appLaunch:!0,appShow:!0,appHide:!0,pageShow:!0,mpClick:!0};autoTrack.init=function(a,t){autoTrack._sa=a,a.appLaunch=appLaunch,a.appShow=appShow,a.appHide=appHide,a.pageShow=pageShow,this.setPresetEvents(a,t)},autoTrack.setPresetEvents=function(a,t){if(a.para.autoTrack=extend(preset_events,t),isFunction(a.platform_obj.onAppShow)&&isFunction(a.platform_obj.onAppHide)&&isFunction(a.platform_obj.getLaunchOptionsSync))a.platform_obj.onAppShow(function(t){if(!a.para.launched){var e=a.platform_obj.getLaunchOptionsSync()||{};a.appLaunch(e),a.para.launched=!0}a.appShow(t)}),a.platform_obj.onAppHide(function(){a.appHide()});else{var e=App;try{App=function(t){var r=t.onShow,n=t.onLaunch,o=t.onHide;t.onLaunch=function(){this[a.para.name]=a,n&&n.apply(this,arguments),a.appLaunch(arguments[0],{},!0)},t.onShow=function(){r&&r.apply(this,arguments),a.appShow(arguments[0],{},!0)},t.onHide=function(){o&&o.apply(this,arguments),a.appHide({},!0)},e.apply(this,arguments)}}catch(a){e.apply(this,arguments)}}var r=Page,n=Component;try{Page=function(t){try{var e;if(a.para.autoTrack&&a.para.autoTrack.mpClick&&(e=getMethods(t)),e)for(var n=0,o=e.length;n<o;n++)clickProxy(t,e[n]);var c=t.onLoad,p=t.onShow;t.onLoad=function(){c&&c.apply(this,arguments),pageLoad.apply(this,arguments)},t.onShow=function(){p&&p.apply(this),pageShow.apply(this)},r.apply(this,arguments)}catch(a){r.apply(this,arguments)}},Component=function(a){try{var t=a.methods.onLoad,e=a.methods.onShow;a.methods.onLoad=function(){t&&t.apply(this,arguments),pageLoad.apply(this,arguments)},a.methods.onShow=function(){e&&e.apply(this),pageShow.apply(this)},n.apply(this,arguments)}catch(a){n.apply(this,arguments)}}}catch(a){Page=function(){r.apply(this,arguments)},Component=function(){n.apply(this,arguments)}}};export default autoTrack;