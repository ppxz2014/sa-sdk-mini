const _toString=Object.prototype.toString,_isArray=Array.prototype.isArray;function isArray(n){return _isArray||'[object Array]'===_toString.call(n)}function utf8Encode(n){var t,a,e,o,c='';for(t=a=0,e=(n=(n+'').replace(/\r\n/g,'\n').replace(/\r/g,'\n')).length,o=0;o<e;o++){var s=n.charCodeAt(o),i=null;s<128?a++:i=s>127&&s<2048?String.fromCharCode(s>>6|192,63&s|128):String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128),null!==i&&(a>t&&(c+=n.substring(t,a)),c+=i,t=a=o+1)}return a>t&&(c+=n.substring(t,n.length)),c}function base64Encode(n){var t,a,e,o,c,s='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',i=0,r=0,u='',d=[];if(!n)return n;n=utf8Encode(n);do{t=(c=n.charCodeAt(i++)<<16|n.charCodeAt(i++)<<8|n.charCodeAt(i++))>>18&63,a=c>>12&63,e=c>>6&63,o=63&c,d[r++]=s.charAt(t)+s.charAt(a)+s.charAt(e)+s.charAt(o)}while(i<n.length);switch(u=d.join(''),n.length%3){case 1:u=u.slice(0,-2)+'==';break;case 2:u=u.slice(0,-1)+'='}return u}var sa,myApp,getRandomBasic=function(){var n=(new Date).getTime();return function(t){return Math.ceil((n=(9301*n+49297)%233280)/233280*t)}}(),tbConfig={cloudFuncSend:!1,cloudFuncName:'httpTunnel',cloudFuncHandler:'main',cloudAppId:'',path:''};try{myApp=getApp()}catch(n){console.log(n)}var cloudFuncInvoke=function(n){var t={data:n.data};myApp&&myApp.cloud&&myApp.cloud.function&&myApp.cloud.function.invoke?myApp.cloud.function.invoke(tbConfig.cloudFuncName,t,tbConfig.cloudFuncHandler).then(t=>{t&&t.success?n.success&&n.success():n.fail&&n.fail()}).catch(t=>{sa.log('\u6570\u636e\u53d1\u9001\u5931\u8d25!'+JSON.stringify(t)),n.fail&&n.fail()}):sa.log('\u8bf7\u6c42\u5931\u8d25!\u5f53\u524d\u5e94\u7528\u4e0d\u652f\u6301\u6dd8\u5b9d\u4e91\u51fd\u6570!')},cloudAppInvoke=function(n){myApp&&myApp.cloud&&myApp.cloud.application&&myApp.cloud.application.httpRequest?myApp.cloud.application.httpRequest({path:tbConfig.path,method:'POST',headers:{'Content-Type':'application/json;charset=UTF-8'},params:{projectId:''},body:n.data,exts:{cloudAppId:tbConfig.cloudAppId}}).then(t=>{t&&t.success?n.success&&n.success():n.fail&&n.fail()}).catch(t=>{sa.log('\u6570\u636e\u53d1\u9001\u5931\u8d25!'+JSON.stringify(t)),n.fail&&n.fail()}):sa.log('\u8bf7\u6c42\u5931\u8d25!\u5f53\u524d\u5e94\u7528\u4e0d\u652f\u6301\u6dd8\u5b9d\u4e91\u5e94\u7528!')},onceSend=function(n){var t=cloudAppInvoke;tbConfig.cloudFuncSend&&(t=cloudFuncInvoke),n._flush_time=Date.now();var a=JSON.stringify(n);t({data:encodeURIComponent(base64Encode(a))})},batchRequest=function(n){var t=cloudAppInvoke;if(tbConfig.cloudFuncSend&&(t=cloudFuncInvoke),isArray(n.data)&&n.data.length>0){var a=Date.now();n.data.forEach(function(n){n._flush_time=a}),n.data=JSON.stringify(n.data),t({data:'data_list='+encodeURIComponent(base64Encode(n.data)),success:function(){n.success(n.len)},fail:function(){n.fail()}})}else n.success(n.len)},TaobaoSendAdapter={name:'TaobaoSendAdapter',init:function(n,t={}){if(!(sa=n))return console.log('\u5f53\u524d\u4e3bsdk \u521d\u59cb\u5316\u5931\u8d25\uff0c\u8bf7\u4f20\u5165\u6b63\u786e\u7684 sensors \u5bf9\u8c61\uff01'),!1;tbConfig=Object.assign(tbConfig,t),sa.kit&&(sa.kit.batchRequest=batchRequest,sa.kit.onceSend=onceSend,sa.para.show_log&&sa.log('[sensorsData]\uff1aTaobaoSendAdapter \u63d2\u4ef6\u521d\u59cb\u5316\u5b8c\u6210\uff01'))}};export default TaobaoSendAdapter;